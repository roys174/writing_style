# Writing Style
Code for classifying sentence according to their writing style. This is the code used for the style features classification in the following paper:

*The Effect of Different Writing Tasks on Linguistic Style: A Case Study of the ROC Story Cloze Task*

*Roy Schwartz, Maarten Sap, Yannis Konstas, Li Zilles, Yejin Choi and Noah A. Smith*, In proceedings of CoNLL 2017 ([pdf](https://arxiv.org/abs/1702.01841), [bib](http://homes.cs.washington.edu/~roysch/papers/language_constraint/language_constraint.bib))

### This Branch
Supports multi-class classification

### Requirements:

-- python (any version), with numpy, sklearn and spacy

-- perl5

### Running:

    1. perl gen_features.PL -feature_file features_list.dat -if <train file tagged> -of train_features.dat

-- This script generates the features list and the the feature values for the train set. The train set should be of the following format: 
<label1>	<w11_t11> <w12_t12> ... <w1n_t1n>
<label2>	<w21_t21> <w22_t22> ... <w2n_t2n>
...

For example: 
0   I_PRP love_VB chocolate_NN ._.
1	I_PRP also_RB like_VB cheese_NN cake_NN ._.

	2. perl gen_features.PL -feature_file features_list.dat -if <dev file tagged> -of dev_features.dat
-- This script generates the feature values for the dev set, based on the features list generated by the train set (the file features_list.dat should be the same file generated from the previous call).

-- Note that in order to regenerate the list of features (step 1), you need to remove the features_list.dat file (or run it with a different file name), otherwise it will just regenerate the same feature values for the training set.

-- You can also control for the length of the character n_gram features (using -char_ngrams <value>, default is 5), the pattern length (--max_patt_len <value>, default is 5), and the minimal feature threshold (-min_thr <value>, default is 100)
	
	3. Run either:
	
	python train.py -i train_features.dat -e features_list.dat -o model.bin
	
	or 
	
	python train.py -i train_features.dat -e features_list.dat -o model.bin -d dev_features.dat
	
-- Trains a logistic regression model on the features. The first version runs n-fold cross-validation on a range of regularization parameters (you can change these with -c "C1,C2,...", default is 1,0.5,0.1,0.05,0.01). The second version select the best paramer using the development set. In both versions, the best value is then used to train the entire train set and the model is saved to model.bin. 

	4. python test.py <test_file_tagged> model.bin
	
-- Evaluates saved model on test file



### Misc

-- The pre-processing step generates different train/dev splits each time, so results will vary between runs (and specifically different from the results published in the paper).

### Contact
roysch@cs.washington.edu

